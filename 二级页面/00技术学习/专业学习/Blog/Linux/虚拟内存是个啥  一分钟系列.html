<html>
<head>
  <title>Evernote Export</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/600753 (zh-CN, DDL); Windows/10.0.0 (Win64);"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="7977"/>

<div>
<span><div style="padding:8px 0px;margin:8px auto;max-width:700px;"><div style="margin:0;padding:0;background-color:#fff"><div style="margin:0;padding:0"><div style="margin:0;padding:0"><h2 style="margin: 0px 0px 14px; padding: 0px; font-size: 22px;"><span style="margin:0px;"><span style="font-size: 22px; font-weight: 400; line-height: 1.4;">虚拟内存是个啥 | 一分钟系列</span></span></h2><div style="margin: 0px; padding: 0px; overflow: hidden; font-size: 17px; word-wrap: break-word; text-align: justify; position: relative; z-index: 0;"><div style="margin: 22px 0px; padding: 0px; clear: both; min-height: 1em; max-width: 100% !important; box-sizing: border-box !important; word-wrap: break-word !important;"><span style="margin: 0px; padding: 0px; font-size: 16px; max-width: 100% !important; box-sizing: border-box !important; word-wrap: break-word !important; color: rgb(51, 51, 51);">字节：</span></div><div style="padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;margin:22px auto;text-align:center"><span style="color: rgb(51, 51, 51); font-size: 17px;"><img src="虚拟内存是个啥  一分钟系列_files/640.jpg" type="image/jpeg" data-filename="640.jpg" style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;height:auto !important;width:auto;border-style:none;max-height:none;visibility:visible;background-position:50% center;background-repeat:no-repeat;cursor:zoom-in"/></span></div><h2 style="margin: 35px 0px 10px; padding: 0px 0px 12px; font-size: 24px; border-bottom: 1px solid rgb(236, 236, 236); max-width: 100% !important; box-sizing: border-box !important; word-wrap: break-word !important;"><span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:24px"><span style="color: rgb(51, 51, 51); font-size: 24px; font-weight: bold; line-height: 1.5; margin: 0px; padding: 0px; max-width: 100%; box-sizing: border-box; word-wrap: break-word;">很久之前的内存</span></span></h2><div style="margin: 22px 0px; padding: 0px; clear: both; min-height: 1em; max-width: 100% !important; box-sizing: border-box !important; word-wrap: break-word !important;"><span style="margin: 0px; padding: 0px; font-size: 16px; max-width: 100% !important; box-sizing: border-box !important; word-wrap: break-word !important; color: rgb(51, 51, 51);">很久很久之前，一台机器上只放置一个程序，操作系统仅仅作为一个函数库存在。对于内存来说，除去操作系统的代码和数据占用的一些空间外，其余空间全部分配给正在运行的那个程序，画个图就是这样：</span></div><div style="padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;margin:22px auto;text-align:center"><span style="color: rgb(51, 51, 51); font-size: 17px;"><img src="虚拟内存是个啥  一分钟系列_files/640 [1].jpg" type="image/jpeg" data-filename="640.jpg" style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;height:auto !important;width:auto;border-style:none;max-height:none;visibility:visible;background-position:50% center;background-repeat:no-repeat;cursor:zoom-in"/></span></div><blockquote style="border-left: 4px solid rgb(247, 81, 81); font-size: 15px; margin: 22px 0px 22px 8px; padding: 1px 23px; background-color: rgb(248, 248, 248); max-width: 100% !important; box-sizing: border-box !important; word-wrap: break-word !important;"><div style="margin: 10px 0px; padding: 0px; clear: both; min-height: 1em; max-width: 100% !important; box-sizing: border-box !important; word-wrap: break-word !important;"><span style="margin: 0px; padding: 0px; font-size: 16px; max-width: 100% !important; box-sizing: border-box !important; word-wrap: break-word !important; color: rgb(102, 102, 102);">小贴士：我们把运行着的程序称之为进程。</span></div></blockquote><h2 style="margin: 35px 0px 10px; padding: 0px 0px 12px; font-size: 24px; border-bottom: 1px solid rgb(236, 236, 236); max-width: 100% !important; box-sizing: border-box !important; word-wrap: break-word !important;"><span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:24px"><span style="color: rgb(51, 51, 51); font-size: 24px; font-weight: bold; line-height: 1.5; margin: 0px; padding: 0px; max-width: 100%; box-sizing: border-box; word-wrap: break-word;">同时运行多个程序的内存</span></span></h2><div style="margin: 22px 0px; padding: 0px; clear: both; min-height: 1em; max-width: 100% !important; box-sizing: border-box !important; word-wrap: break-word !important;"><span style="margin: 0px; padding: 0px; font-size: 16px; max-width: 100% !important; box-sizing: border-box !important; word-wrap: break-word !important; color: rgb(51, 51, 51);">后来人们觉得同时在一台计算机上只运行一个程序太亏了，就设计了一个可以同时运行多个程序的机制。不过内存条只有一个，所以这些用户程序只能共享同一个内存条，只能把内存的不同部分划分给不同的用户程序，画个图就像是这样：</span></div><div style="padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;margin:22px auto;text-align:center"><span style="color: rgb(51, 51, 51); font-size: 17px;"><img src="虚拟内存是个啥  一分钟系列_files/640 [2].jpg" type="image/jpeg" data-filename="640.jpg" style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;height:auto !important;width:auto;border-style:none;max-height:none;visibility:visible;background-position:50% center;background-repeat:no-repeat;cursor:zoom-in"/></span></div><div style="margin: 22px 0px; padding: 0px; clear: both; min-height: 1em; max-width: 100% !important; box-sizing: border-box !important; word-wrap: break-word !important;"><span style="margin: 0px; padding: 0px; font-size: 16px; max-width: 100% !important; box-sizing: border-box !important; word-wrap: break-word !important; color: rgb(51, 51, 51);">这样子的话也有一些问题：</span></div><ul style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;padding-left:2.2em"><li style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"><div style="margin: 22px 0px; padding: 0px; clear: both; min-height: 1em; max-width: 100% !important; box-sizing: border-box !important; word-wrap: break-word !important;"><span style="margin: 0px; padding: 0px; font-size: 16px; max-width: 100% !important; box-sizing: border-box !important; word-wrap: break-word !important; color: rgb(51, 51, 51);">不同用户程序只能使用给他们规定好的那部分内存，也就是程序员在敲代码的时候就应该小心翼翼的计算自己使用的内存有没有占到别人家的地儿，这样对码农很不友好有木有。</span></div></li><li style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"><div style="margin: 22px 0px; padding: 0px; clear: both; min-height: 1em; max-width: 100% !important; box-sizing: border-box !important; word-wrap: break-word !important;"><span style="margin: 0px; padding: 0px; font-size: 16px; max-width: 100% !important; box-sizing: border-box !important; word-wrap: break-word !important; color: rgb(51, 51, 51);">如果哪个心眼儿坏的家伙故意去读取别人家的程序使用的内存，这不就暴露了么，更严重的，这个坏家伙直接把别人家程序正在使用的内存的某些字节给更新掉，这就是天坑了～</span></div></li><li style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important"><div style="margin: 22px 0px; padding: 0px; clear: both; min-height: 1em; max-width: 100% !important; box-sizing: border-box !important; word-wrap: break-word !important;"><span style="margin: 0px; padding: 0px; font-size: 16px; max-width: 100% !important; box-sizing: border-box !important; word-wrap: break-word !important; color: rgb(51, 51, 51);">能使用的内存空间都给规定好了，太少了有木有～</span></div></li></ul><h2 style="margin: 35px 0px 10px; padding: 0px 0px 12px; font-size: 24px; border-bottom: 1px solid rgb(236, 236, 236); max-width: 100% !important; box-sizing: border-box !important; word-wrap: break-word !important;"><span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:24px"><span style="color: rgb(51, 51, 51); font-size: 24px; font-weight: bold; line-height: 1.5; margin: 0px; padding: 0px; max-width: 100%; box-sizing: border-box; word-wrap: break-word;">虚拟内存</span></span></h2><div style="margin: 22px 0px; padding: 0px; clear: both; min-height: 1em; max-width: 100% !important; box-sizing: border-box !important; word-wrap: break-word !important;"><span style="margin: 0px; padding: 0px; font-size: 16px; max-width: 100% !important; box-sizing: border-box !important; word-wrap: break-word !important; color: rgb(51, 51, 51);">操作系统是个老好人，使命就是解决所有用户感到麻烦的事情。设计操作系统的大叔觉得，如果让用户直接去操作内存的话，用户也不知道其他人到底使用了内存的哪些字节，自己可以使用哪些字节，如果要做到这一点的话人们在开发程序的时候还要聚到一起开个会，把每个人该用哪块内存都规定好，即使规定好了用户还得小心翼翼的避免使用了不属于自己的那部分内存。干脆，干脆就不让用户直接操作内存了，让用户在编程序的时候直接把内存想象成一个非常非常大的字节数组就好了，，自己在这个字节数组上可以随便折腾，他们把这个非常大的字节数组称之为</span><code style="margin: 0px; font-size: 0.87em; padding: 0.065em 0.4em; word-break: break-word; background-color: rgb(255, 245, 245); border-radius: 2px; overflow-x: auto; max-width: 100% !important; box-sizing: border-box !important; word-wrap: break-word !important;"><span style="margin: 0px; padding: 0px; font-size: 16px; max-width: 100% !important; box-sizing: border-box !important; word-wrap: break-word !important; color: rgb(255, 80, 44); background-color: rgb(255, 245, 245); font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace;">虚拟内存</span></code><span style="margin: 0px; padding: 0px; font-size: 16px; max-width: 100% !important; box-sizing: border-box !important; word-wrap: break-word !important; color: rgb(51, 51, 51);">，由操作系统完成从虚拟内存的虚拟地址到真实内存的真实地址之间的映射工作。画个图就像这样：</span></div><div style="padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;margin:22px auto;text-align:center"><span style="color: rgb(51, 51, 51); font-size: 17px;"><img src="虚拟内存是个啥  一分钟系列_files/640 [3].jpg" type="image/jpeg" data-filename="640.jpg" style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;height:auto !important;width:auto;border-style:none;max-height:none;visibility:visible;background-position:50% center;background-repeat:no-repeat;cursor:zoom-in"/></span></div><div style="margin: 22px 0px; padding: 0px; clear: both; min-height: 1em; max-width: 100% !important; box-sizing: border-box !important; word-wrap: break-word !important;"><span style="margin: 0px; padding: 0px; font-size: 16px; max-width: 100% !important; box-sizing: border-box !important; word-wrap: break-word !important; color: rgb(51, 51, 51);">这样还有问题，用户越来越多，即使每个用户都使用非常少的内存空间，那加起来占用的内存空间都可能超过了真实内存的大小，更何况某些丧心病狂的程序员写的程序里本身就使用了超过真正内存大小的空间，这可怎么办。这难不倒设计操作系统的大叔们，他们机智的把硬盘也拉了进来。</span></div><div style="padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;margin:22px auto;text-align:center"><span style="color: rgb(51, 51, 51); font-size: 17px;"><img src="虚拟内存是个啥  一分钟系列_files/640 [4].jpg" type="image/jpeg" data-filename="640.jpg" style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;height:auto !important;width:auto;border-style:none;max-height:none;visibility:visible;background-position:50% center;background-repeat:no-repeat;cursor:zoom-in"/></span></div><div style="margin: 22px 0px; padding: 0px; clear: both; min-height: 1em; max-width: 100% !important; box-sizing: border-box !important; word-wrap: break-word !important;"><span style="margin: 0px; padding: 0px; font-size: 16px; max-width: 100% !important; box-sizing: border-box !important; word-wrap: break-word !important; color: rgb(51, 51, 51);">操作系统完成由虚拟内存地址到真实内存地址或者磁盘地址之间的映射工作，这样子给用户提供的虚拟内存的地址空间就可以非常非常大，用户程序中那些很久都用不到的内存空间可以被操作系统给搞到磁盘上边存储，什么时候需要用了，又从磁盘中加载到真实内存中，重要的是这个过程全部是操作系统自动完成的，对于我们这些码农来说，编写程序就像是在一个炒鸡大的字节数组上将某个地方的数据搬到另一个地方，或者将某个地方的数据经过CPU的某种加工之后再放到某个字节数组的某个地方，整个过程so easy，完全不用担心有没有读取/覆盖掉别人正在使用的内存空间。</span></div><blockquote style="border-left: 4px solid rgb(247, 81, 81); font-size: 15px; margin: 22px 0px 22px 8px; padding: 1px 23px; background-color: rgb(248, 248, 248); max-width: 100% !important; box-sizing: border-box !important; word-wrap: break-word !important;"><div style="margin: 10px 0px; padding: 0px; clear: both; min-height: 1em; max-width: 100% !important; box-sizing: border-box !important; word-wrap: break-word !important;"><span style="margin: 0px; padding: 0px; font-size: 16px; max-width: 100% !important; box-sizing: border-box !important; word-wrap: break-word !important; color: rgb(102, 102, 102);">小贴士：对于Windows操作系统来说，虚拟内存所需的磁盘空间从系统盘，一般是C盘分配，当你的C盘剩余空间很少时就会导致很卡～</span></div></blockquote><h2 style="margin: 35px 0px 10px; padding: 0px 0px 12px; font-size: 24px; border-bottom: 1px solid rgb(236, 236, 236); max-width: 100% !important; box-sizing: border-box !important; word-wrap: break-word !important;"><span style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;font-size:24px"><span style="color: rgb(51, 51, 51); font-size: 24px; font-weight: bold; line-height: 1.5; margin: 0px; padding: 0px; max-width: 100%; box-sizing: border-box; word-wrap: break-word;">虚拟内存结构</span></span></h2><div style="margin: 22px 0px; padding: 0px; clear: both; min-height: 1em; max-width: 100% !important; box-sizing: border-box !important; word-wrap: break-word !important;"><span style="margin: 0px; padding: 0px; font-size: 16px; max-width: 100% !important; box-sizing: border-box !important; word-wrap: break-word !important; color: rgb(51, 51, 51);">我们说对于敲代码的码农来说，</span><code style="margin: 0px; font-size: 0.87em; padding: 0.065em 0.4em; word-break: break-word; background-color: rgb(255, 245, 245); border-radius: 2px; overflow-x: auto; max-width: 100% !important; box-sizing: border-box !important; word-wrap: break-word !important;"><span style="margin: 0px; padding: 0px; font-size: 16px; max-width: 100% !important; box-sizing: border-box !important; word-wrap: break-word !important; color: rgb(255, 80, 44); background-color: rgb(255, 245, 245); font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace;">虚拟内存</span></code><span style="margin: 0px; padding: 0px; font-size: 16px; max-width: 100% !important; box-sizing: border-box !important; word-wrap: break-word !important; color: rgb(51, 51, 51);">就是一个超级大的字节数组，不过这个字节数组也是被划分为多个部分的，并不是每个地方用户都可以访问，一般的虚拟内存结构长这样：</span></div><div style="padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;margin:22px auto;text-align:center"><span style="color: rgb(51, 51, 51); font-size: 17px;"><img src="虚拟内存是个啥  一分钟系列_files/640 [5].jpg" type="image/jpeg" data-filename="640.jpg" style="margin:0;padding:0;max-width:100% !important;box-sizing:border-box !important;-webkit-box-sizing:border-box !important;word-wrap:break-word !important;height:auto !important;width:auto;border-style:none;max-height:none;visibility:visible;background-position:50% center;background-repeat:no-repeat;cursor:zoom-in"/></span></div><div style="margin: 22px 0px; padding: 0px; clear: both; min-height: 1em; max-width: 100% !important; box-sizing: border-box !important; word-wrap: break-word !important;"><span style="margin: 0px; padding: 0px; font-size: 16px; max-width: 100% !important; box-sizing: border-box !important; word-wrap: break-word !important; color: rgb(51, 51, 51);">用户需要调用函数的时候，一般都会生成一个称之为</span><code style="margin: 0px; font-size: 0.87em; padding: 0.065em 0.4em; word-break: break-word; background-color: rgb(255, 245, 245); border-radius: 2px; overflow-x: auto; max-width: 100% !important; box-sizing: border-box !important; word-wrap: break-word !important;"><span style="margin: 0px; padding: 0px; font-size: 16px; max-width: 100% !important; box-sizing: border-box !important; word-wrap: break-word !important; color: rgb(255, 80, 44); background-color: rgb(255, 245, 245); font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace;">栈帧</span></code><span style="margin: 0px; padding: 0px; font-size: 16px; max-width: 100% !important; box-sizing: border-box !important; word-wrap: break-word !important; color: rgb(51, 51, 51);">的结构，从而导致虚拟内存中的</span><code style="margin: 0px; font-size: 0.87em; padding: 0.065em 0.4em; word-break: break-word; background-color: rgb(255, 245, 245); border-radius: 2px; overflow-x: auto; max-width: 100% !important; box-sizing: border-box !important; word-wrap: break-word !important;"><span style="margin: 0px; padding: 0px; font-size: 16px; max-width: 100% !important; box-sizing: border-box !important; word-wrap: break-word !important; color: rgb(255, 80, 44); background-color: rgb(255, 245, 245); font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace;">栈空间</span></code><span style="margin: 0px; padding: 0px; font-size: 16px; max-width: 100% !important; box-sizing: border-box !important; word-wrap: break-word !important; color: rgb(51, 51, 51);">增长。</span></div><div style="margin: 22px 0px; padding: 0px; clear: both; min-height: 1em; max-width: 100% !important; box-sizing: border-box !important; word-wrap: break-word !important;"><span style="margin: 0px; padding: 0px; font-size: 16px; max-width: 100% !important; box-sizing: border-box !important; word-wrap: break-word !important; color: rgb(51, 51, 51);">用户需要单独申请内存空间时，就会从堆空间分配，从而导致虚拟内存中的</span><code style="margin: 0px; font-size: 0.87em; padding: 0.065em 0.4em; word-break: break-word; background-color: rgb(255, 245, 245); border-radius: 2px; overflow-x: auto; max-width: 100% !important; box-sizing: border-box !important; word-wrap: break-word !important;"><span style="margin: 0px; padding: 0px; font-size: 16px; max-width: 100% !important; box-sizing: border-box !important; word-wrap: break-word !important; color: rgb(255, 80, 44); background-color: rgb(255, 245, 245); font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace;">堆空间</span></code><span style="margin: 0px; padding: 0px; font-size: 16px; max-width: 100% !important; box-sizing: border-box !important; word-wrap: break-word !important; color: rgb(51, 51, 51);">增长。</span></div><div style="margin: 22px 0px; padding: 0px; clear: both; min-height: 1em; max-width: 100% !important; box-sizing: border-box !important; word-wrap: break-word !important;"><span style="margin: 0px; padding: 0px; font-size: 16px; max-width: 100% !important; box-sizing: border-box !important; word-wrap: break-word !important; color: rgb(51, 51, 51);">这里需要强调的一点是，我们平时所说的操作系统</span><code style="margin: 0px; font-size: 0.87em; padding: 0.065em 0.4em; word-break: break-word; background-color: rgb(255, 245, 245); border-radius: 2px; overflow-x: auto; max-width: 100% !important; box-sizing: border-box !important; word-wrap: break-word !important;"><span style="margin: 0px; padding: 0px; font-size: 16px; max-width: 100% !important; box-sizing: border-box !important; word-wrap: break-word !important; color: rgb(255, 80, 44); background-color: rgb(255, 245, 245); font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace;">内核</span></code><span style="margin: 0px; padding: 0px; font-size: 16px; max-width: 100% !important; box-sizing: border-box !important; word-wrap: break-word !important; color: rgb(51, 51, 51);">不是一个进程，而是指操作系统的代码。</span></div></div></div><div style="margin:0;padding:0;padding-top:15px"><div style="margin:0;padding:0"><span style="margin:0;padding:0;visibility:hidden"><span style="margin:0;padding:0"><span style="margin:0;padding:0">在看</span></span></span></div></div></div></div></div><div><br/></div></span>
</div></body></html> 